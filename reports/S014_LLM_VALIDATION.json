{
  "scenario": "S014_BVLOS_Waiver",
  "scenario_type": "vlos",
  "timestamp": "2025-10-31T17:13:20.101405",
  "summary": {
    "total_test_cases": 6,
    "llm_accuracy": "6/6",
    "llm_accuracy_percent": "100.0%"
  },
  "results": [
    {
      "test_case_id": "TC1",
      "description": "基础VLOS内飞行（400m），无需豁免",
      "command": "move_to_position(400, 0, 50)",
      "ground_truth": {
        "decision": "APPROVE"
      },
      "llm_result": {
        "decision": "APPROVE",
        "reasoning": "The flight's maximum horizontal distance from the operator is 400m, which is well within the standard 500m Visual Line of Sight (VLOS) limit. Therefore, no Beyond Visual Line of Sight (BVLOS) waivers are required, and the flight is compliant with VLOS regulations.",
        "analysis": {
          "decision": "APPROVE",
          "reasoning": "The flight's maximum horizontal distance from the operator is 400m, which is well within the standard 500m Visual Line of Sight (VLOS) limit. Therefore, no Beyond Visual Line of Sight (BVLOS) waivers are required, and the flight is compliant with VLOS regulations.",
          "detailed_steps": [
            "Step 1: Horizontal distances calculated.",
            "   - Distance from operator (0.0, 0.0) to start position (0.0, 0.0): sqrt((0-0)^2 + (0-0)^2) = 0.0 meters.",
            "   - Distance from operator (0.0, 0.0) to target position (400.0, 0.0): sqrt((400-0)^2 + (0-0)^2) = 400.0 meters.",
            "   - Maximum horizontal distance during straight-line flight (from (0.0,0.0) to (400.0,0.0) with operator at (0.0,0.0)) is 400.0 meters.",
            "Step 2: VLOS requirement check.",
            "   - The maximum distance during flight (400.0m) is less than or equal to the standard VLOS limit of 500m (400.0m <= 500m).",
            "   - Therefore, the flight remains within Visual Line of Sight.",
            "Step 3: BVLOS waivers check (not needed).",
            "   - Since the flight is compliant with VLOS requirements, BVLOS operations are not being conducted, and no BVLOS waivers are required or evaluated."
          ],
          "vlos_analysis": {
            "operator_position": [
              0.0,
              0.0
            ],
            "max_distance_to_operator_m": 400.0,
            "vlos_limit_m": 500,
            "within_vlos": true,
            "requires_bvlos_waiver": false,
            "waiver_available": false,
            "waiver_sufficient": false
          }
        },
        "correct": true
      }
    },
    {
      "test_case_id": "TC2",
      "description": "超视距飞行（600m），无豁免应拒绝",
      "command": "move_to_position(600, 0, 50)",
      "ground_truth": {
        "decision": "REJECT"
      },
      "llm_result": {
        "decision": "REJECT",
        "reasoning": "The flight plan exceeds the standard 500-meter Visual Line of Sight (VLOS) limit, reaching a maximum horizontal distance of 600 meters from the operator. No Beyond Visual Line of Sight (BVLOS) waivers are active for this operation, thus violating regulations.",
        "analysis": {
          "decision": "REJECT",
          "reasoning": "The flight plan exceeds the standard 500-meter Visual Line of Sight (VLOS) limit, reaching a maximum horizontal distance of 600 meters from the operator. No Beyond Visual Line of Sight (BVLOS) waivers are active for this operation, thus violating regulations.",
          "detailed_steps": [
            "Step 1: Calculate horizontal distance.",
            "   - Distance from operator (0.0, 0.0) to start position (0.0, 0.0): sqrt((0.0-0.0)^2 + (0.0-0.0)^2) = 0.0 meters.",
            "   - Distance from operator (0.0, 0.0) to target position (600.0, 0.0): sqrt((600.0-0.0)^2 + (0.0-0.0)^2) = 600.0 meters.",
            "   - The maximum horizontal distance from the operator during the straight-line flight is 600.0 meters, occurring at the target position.",
            "Step 2: Check VLOS requirement.",
            "   - The maximum distance during flight (600.0 meters) is greater than the standard VLOS limit of 500 meters.",
            "   - Therefore, the flight requires Beyond Visual Line of Sight (BVLOS) authorization.",
            "Step 3: Check BVLOS waivers.",
            "   - The flight plan explicitly states 'No BVLOS waivers active'.",
            "   - As no waiver is active, the BVLOS requirement cannot be met.",
            "Step 4: Make final decision.",
            "   - Since the flight exceeds VLOS limits (600m > 500m) and no BVLOS waivers are active, the flight is non-compliant and is REJECTED."
          ],
          "vlos_analysis": {
            "operator_position": [
              0.0,
              0.0
            ],
            "max_distance_to_operator_m": 600.0,
            "vlos_limit_m": 500,
            "within_vlos": false,
            "requires_bvlos_waiver": true,
            "waiver_available": false,
            "waiver_sufficient": false
          }
        },
        "correct": true
      }
    },
    {
      "test_case_id": "TC3",
      "description": "超视距飞行（600m），启用观察员豁免应批准",
      "command": "move_to_position(600, 0, 50)",
      "ground_truth": {
        "decision": "APPROVE"
      },
      "llm_result": {
        "decision": "APPROVE",
        "reasoning": "The flight exceeds the standard 500m VLOS limit, reaching a maximum distance of 600m from the operator. However, an active BVLOS waiver (W001_VisualObserver) for a visual observer is in place, extending the permissible range to 1100m, which successfully covers the flight's maximum distance. Thus, the flight is compliant with the active waiver.",
        "analysis": {
          "decision": "APPROVE",
          "reasoning": "The flight exceeds the standard 500m VLOS limit, reaching a maximum distance of 600m from the operator. However, an active BVLOS waiver (W001_VisualObserver) for a visual observer is in place, extending the permissible range to 1100m, which successfully covers the flight's maximum distance. Thus, the flight is compliant with the active waiver.",
          "detailed_steps": [
            "Step 1: Calculate horizontal distances.",
            "Distance from operator (0,0) to start position (0,0): 0.0m.",
            "Distance from operator (0,0) to target position (600,0): 600.0m.",
            "Maximum horizontal distance from operator during flight: 600.0m (at the target position).",
            "Step 2: Check VLOS requirement.",
            "The maximum distance (600.0m) is greater than the standard VLOS limit (500m).",
            "Therefore, the flight is not within standard VLOS and requires a BVLOS waiver.",
            "Step 3: Check BVLOS waivers.",
            "An active BVLOS waiver, 'W001_VisualObserver' (type: visual_observer), is available.",
            "This waiver has a maximum effective range of 1100.0m.",
            "The required maximum distance for this flight is 600.0m.",
            "Since 600.0m is less than or equal to the waiver's range of 1100.0m, the waiver is sufficient to cover the flight.",
            "Step 4: Make final decision.",
            "The flight exceeds VLOS but is covered by a valid and sufficient BVLOS waiver. Decision: APPROVE."
          ],
          "vlos_analysis": {
            "operator_position": [
              0.0,
              0.0
            ],
            "max_distance_to_operator_m": 600.0,
            "vlos_limit_m": 500,
            "within_vlos": false,
            "requires_bvlos_waiver": true,
            "waiver_available": true,
            "waiver_sufficient": true
          }
        },
        "correct": true
      }
    },
    {
      "test_case_id": "TC4",
      "description": "远距离飞行（1500m），启用技术手段豁免应批准",
      "command": "move_to_position(1500, 0, 50)",
      "ground_truth": {
        "decision": "APPROVE"
      },
      "llm_result": {
        "decision": "APPROVE",
        "reasoning": "The flight exceeds the standard 500m VLOS limit, but is compliant due to an active BVLOS waiver (W002_TechnicalMeans) for technical means, which covers the maximum flight distance of 1500.0m within its 2000.0m effective range.",
        "analysis": {
          "decision": "APPROVE",
          "reasoning": "The flight exceeds the standard 500m VLOS limit, but is compliant due to an active BVLOS waiver (W002_TechnicalMeans) for technical means, which covers the maximum flight distance of 1500.0m within its 2000.0m effective range.",
          "detailed_steps": [
            "Step 1: Horizontal distances calculated. Distance from operator to start position is 0.0m. Distance from operator to target position is 1500.0m. The maximum horizontal distance from the operator during the straight-line flight is 1500.0m.",
            "Step 2: VLOS requirement check. The maximum flight distance of 1500.0m exceeds the standard VLOS limit of 500m. Therefore, this flight requires BVLOS authorization.",
            "Step 3: BVLOS waiver check. An active BVLOS waiver (W002_TechnicalMeans) of type 'technical_means' is present, which has a maximum effective range of 2000.0m. The maximum flight distance of 1500.0m is within this waiver's effective range (1500.0m ≤ 2000.0m). The waiver is sufficient.",
            "Step 4: Final decision. The flight is APPROVED as it requires BVLOS operation, and a valid and sufficient BVLOS waiver is active for the planned distance."
          ],
          "vlos_analysis": {
            "operator_position": [
              0.0,
              0.0
            ],
            "max_distance_to_operator_m": 1500.0,
            "vlos_limit_m": 500,
            "within_vlos": false,
            "requires_bvlos_waiver": true,
            "waiver_available": true,
            "waiver_sufficient": true
          }
        },
        "correct": true
      }
    },
    {
      "test_case_id": "TC5",
      "description": "超远距离飞行（3000m），启用特殊许可应批准",
      "command": "move_to_position(3000, 0, 50)",
      "ground_truth": {
        "decision": "APPROVE"
      },
      "llm_result": {
        "decision": "APPROVE",
        "reasoning": "The flight exceeds the standard VLOS limit of 500m but is covered by an active 'special_permit' BVLOS waiver (W003_SpecialPermit) which allows operations up to 5000m, well within the flight's maximum distance of 3000m.",
        "analysis": {
          "decision": "APPROVE",
          "reasoning": "The flight exceeds the standard VLOS limit of 500m but is covered by an active 'special_permit' BVLOS waiver (W003_SpecialPermit) which allows operations up to 5000m, well within the flight's maximum distance of 3000m.",
          "detailed_steps": [
            "Step 1: Calculate horizontal distances.",
            "   - Distance from operator (0.0, 0.0) to start position (0.0, 0.0): 0.0m",
            "   - Distance from operator (0.0, 0.0) to target position (3000.0, 0.0): sqrt((3000.0-0.0)^2 + (0.0-0.0)^2) = 3000.0m",
            "   - Maximum distance during straight-line flight from operator: 3000.0m.",
            "Step 2: Check VLOS requirement.",
            "   - The maximum distance during flight (3000.0m) is greater than the standard VLOS limit of 500m.",
            "   - Therefore, this flight requires BVLOS authorization.",
            "Step 3: Check BVLOS waivers.",
            "   - An active BVLOS waiver 'W003_SpecialPermit' (Type: special_permit) is present.",
            "   - This waiver allows for a 'Max effective range' of 5000.0m.",
            "   - The flight's maximum distance of 3000.0m is within the waiver's effective range (3000.0m <= 5000.0m).",
            "   - The 'special_permit' type is a valid BVLOS authorization method.",
            "Step 4: Make final decision.",
            "   - The flight exceeds VLOS but is fully compliant with the active BVLOS special permit waiver. Decision: APPROVE."
          ],
          "vlos_analysis": {
            "operator_position": [
              0.0,
              0.0
            ],
            "max_distance_to_operator_m": 3000.0,
            "vlos_limit_m": 500,
            "within_vlos": false,
            "requires_bvlos_waiver": true,
            "waiver_available": true,
            "waiver_sufficient": true
          }
        },
        "correct": true
      }
    },
    {
      "test_case_id": "TC6",
      "description": "超远距离飞行（6000m），即使有特殊许可也超出范围应拒绝",
      "command": "move_to_position(6000, 0, 50)",
      "ground_truth": {
        "decision": "REJECT"
      },
      "llm_result": {
        "decision": "REJECT",
        "reasoning": "The flight's maximum horizontal distance of 6000.0m from the operator significantly exceeds the standard 500m VLOS limit, requiring BVLOS authorization. Although a special permit BVLOS waiver is active with a maximum range of 5000.0m, this is insufficient to cover the planned 6000.0m maximum distance. Therefore, the flight is not compliant with current regulations or waivers.",
        "analysis": {
          "decision": "REJECT",
          "reasoning": "The flight's maximum horizontal distance of 6000.0m from the operator significantly exceeds the standard 500m VLOS limit, requiring BVLOS authorization. Although a special permit BVLOS waiver is active with a maximum range of 5000.0m, this is insufficient to cover the planned 6000.0m maximum distance. Therefore, the flight is not compliant with current regulations or waivers.",
          "detailed_steps": [
            "Step 1: Calculate horizontal distances.",
            "   - Distance from operator (0.0, 0.0) to start position (0.0, 0.0) is 0.0m.",
            "   - Distance from operator (0.0, 0.0) to target position (6000.0, 0.0) is sqrt((6000.0-0.0)^2 + (0.0-0.0)^2) = 6000.0m.",
            "   - The maximum horizontal distance from the operator during the straight-line flight is 6000.0m.",
            "Step 2: Check VLOS requirement.",
            "   - The maximum distance during flight (6000.0m) is greater than the standard VLOS limit of 500m.",
            "   - Therefore, the flight requires BVLOS authorization.",
            "Step 3: Check BVLOS waivers.",
            "   - A BVLOS waiver ('W003_SpecialPermit') is active.",
            "   - This waiver is of type 'special_permit' and has a maximum effective range of 5000.0m.",
            "   - The required maximum distance for this flight is 6000.0m.",
            "   - Since 6000.0m > 5000.0m, the active waiver is not sufficient to cover the full extent of the planned BVLOS flight.",
            "Step 4: Make final decision.",
            "   - As the flight requires BVLOS and the active waiver does not cover the maximum distance, the flight plan is rejected."
          ],
          "vlos_analysis": {
            "operator_position": [
              0.0,
              0.0
            ],
            "max_distance_to_operator_m": 6000.0,
            "vlos_limit_m": 500,
            "within_vlos": false,
            "requires_bvlos_waiver": true,
            "waiver_available": true,
            "waiver_sufficient": false
          }
        },
        "correct": true
      }
    }
  ]
}