{
  "id": "S038_CausalTemporal",
  "name": "Causal-Temporal Reasoning Breakdown",
  "version": "1.0",
  "created": "2025-11-12",
  "complexity_layer": 3,
  "llm_only": true,
  "description": "Layer-3 scenario stressing causal/temporal dependencies: out-of-order narration, fork/collider structures, and counterfactual preconditions must be resolved to assess compliance.",
  "causal_guidelines": [
    "Procedural steps must be completed in the prescribed order even if described backwards.",
    "ATC/waiver decisions propagate constraints to all dependent actions (fork structure).",
    "Certain tasks require multiple joint preconditions (collider) – missing any invalidates the task.",
    "Temporary approvals/inspections can expire; consider transitive time windows.",
    "Counterfactual cues (mentioning backup plans) imply prerequisites (main site evaluation) must have happened first."
  ],
  "test_cases": [
    {
      "case_id": "TC01_BackwardsWeather",
      "title": "Weather check reported last",
      "description": "Application describes completing flight, then takeoff, and only at the end mentions checking weather.",
      "facts": [
        "Regulation requires weather review before launch.",
        "Applicant wants retroactive approval after flight."
      ],
      "expected_decision": "EXPLAIN_ONLY",
      "notes": [
        "Explain why the retroactive weather report is invalid and outline the required reset (redo weather review, re-authorize flight)."
      ]
    },
    {
      "case_id": "TC02_ForkATC",
      "title": "ATC fork dependency omitted",
      "description": "Applicant promises to obey approved altitude and route but never mentions obtaining ATC clearance.",
      "facts": [
        "ATC clearance yields both route and altitude approvals (fork).",
        "Mission near class B airspace."
      ],
      "expected_decision": "REJECT",
      "notes": [
        "Without clearance, the promised constraints are unknown; must secure ATC approval first."
      ]
    },
    {
      "case_id": "TC03_ColliderHighRisk",
      "title": "Collider approval missing",
      "description": "High-sensitivity school flyover requires both equipment inspection AND special permit; applicant only mentions inspection.",
      "facts": [
        "Collider structure: inspection ∧ permit → authorization.",
        "Permit not referenced."
      ],
      "expected_decision": "EXPLAIN_ONLY",
      "notes": [
        "Describe how to obtain the missing permit and schedule the flight only after both inspection and permit are documented."
      ]
    },
    {
      "case_id": "TC04_CounterintuitiveMaintenance",
      "title": "Maintenance report filed after inspection",
      "description": "Rules require maintenance docs submitted before inspection scheduling (to verify repairs). Applicant says inspection happened before submitting maintenance report.",
      "facts": [
        "Doc timestamps: inspection 09:00, maintenance report upload 11:00 same day."
      ],
      "expected_decision": "REJECT",
      "notes": [
        "Inspection invalid because documentation order reversed; must redo inspection after filing repairs."
      ]
    },
    {
      "case_id": "TC05_ChainDistance",
      "title": "Distance-triggered chain missing timestamp",
      "description": "Route length 7 km (>5 km threshold). Applicant attaches track but omits timestamps.",
      "facts": [
        "Rule: distance>5 km → submit track; track must include timestamps.",
        "Submission: track image only."
      ],
      "expected_decision": "EXPLAIN_ONLY",
      "notes": [
        "Reject current submission but specify the remediation (resubmit track with timestamps covering the entire 7 km leg)."
      ]
    },
    {
      "case_id": "TC06_BackupWithoutAssessment",
      "title": "Backup landing plan implies missing evaluation",
      "description": "Applicant touts prepared backup landing site but never performed main site safety assessment (precondition for needing backup).",
      "facts": [
        "Rule: only declare backup if main site assessment indicates potential risk.",
        "Application lacks main site evaluation."
      ],
      "expected_decision": "EXPLAIN_ONLY",
      "notes": [
        "Require completion of the main-site assessment first, then resubmit backup plan; describe this sequence in the response."
      ]
    },
    {
      "case_id": "TC07_TransitiveBattery",
      "title": "Detection expiration chain",
      "description": "Battery check at Nov10 10:00, flight plan submission Nov11 09:00, intended flight Nov12 11:00.",
      "facts": [
        "Battery inspection valid 24h; plan inherits inspection timestamp.",
        "Execution scheduled beyond inspection window."
      ],
      "expected_decision": "REJECT",
      "notes": [
        "Inspection → plan → execution must occur within 24h window; schedule violates transitive constraint."
      ]
    },
    {
      "case_id": "TC08_NightAND",
      "title": "Night flight AND logic",
      "description": "Applicant states 'I have strobes or can bring an observer'; rule requires strobes AND night rating AND observer.",
      "facts": [
        "Night ops rule = strobe ∧ night rating ∧ observer.",
        "Applicant offers OR phrasing."
      ],
      "expected_decision": "EXPLAIN_ONLY",
      "notes": [
        "List the missing items (night rating, observer) and instruct the operator to satisfy all AND conditions before approval."
      ]
    },
    {
      "case_id": "TC09_NFZTiming",
      "title": "NFZ activation math inconsistency",
      "description": "NFZ activates 14:00. Applicant claims 12:00 departure, 3h flight but says 'will finish before activation'.",
      "facts": [
        "Flight would end 15:00 > 14:00."
      ],
      "expected_decision": "REJECT",
      "notes": [
        "Causal claim contradicts numbers; must adjust duration or timing."
      ]
    },
    {
      "case_id": "TC10_LoopInsurance",
      "title": "Insurance-license loop",
      "description": "Rule A: commercial flight requires insurance proof. Rule B: insurer needs license number. Applicant says 'approve first, then I'll buy insurance'.",
      "facts": [
        "Industry practice: temporary license number issued first to break loop.",
        "Applicant ignores temporary-number procedure."
      ],
      "expected_decision": "REJECT",
      "notes": [
        "Must obtain insurance via temporary number before final approval; request misorders the loop-breaking steps."
      ]
    }
  ]
}
